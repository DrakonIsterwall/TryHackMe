1.Introduction

Understand where data originates, how it is stored, and how a security engineer can leverage it.
Understand why accountability is important to security and how logging can help improve its efficacy.
Apply logs and other data sources to incident response and the principle of accountability.

Before beginning this room, we recommend you understand logging capabilities and log data sources or complete Intro to Logs. We also recommend a basic understanding of 
Splunk or complete Splunk Basics.

2.Importance of Logging and Data Aggregation

SIEMs have many features and capabilities, often for specific use cases. Below is a summary of the benefits and features that an SIEM can offer at the most basic level:

Real-time log ingestion.
Alerting against abnormal activities.
24/7 monitoring and visibility.
Data insights and visualization.
Ability to investigate past incidents.

Examples of SIEMs may include Wazuh, Splunk, ELK, and QRadar.

Answer:non-repudiation

3.Log Ingestion and Storage

SIEMs are typically architected with three components used for searching, indexing, and load-balancing; these components are commonly known as the search head, indexer, and 
forwarder, respectively.In this room, our objective is accountability, so we will focus primarily on the indexer and how data arrives from a device to the indexer; this 
process is commonly known as data ingestion.

Types of data ingestion
  Agent/forwarder
  Port-forwarding
  Syslog
  Upload

Audits require logs that are saved.The saved logs are in hot,warm and cold storages depending on how often they are used.In general you try to at least have logs saved for 1-3 
years depending on the compliances that you have to fullfill for the branch you are wokring in for example a bank has a different audit and compliances to fullfill then an
little IT-hardware store.

Answers:search head,1

4.Types of Logs and Data Sources

Many log sources exist to collect data efficiently with as much relevant information as possible. In this task, we will outline a few of the most common log sources and how they may be used in the incident response process.

Manual log sources
    Any log that is manually written or composed by an author
    Change logs
Automated log sources
    Any logs that are automatically generated by default, for example, a configuration, tool, or from a developer
    System logs
    Application logs
Other types of logs
    Some logs may not be categorized but are often required for compliance
    Email logs
    Messaging or other communication

A good log source may not include only one log. Due to the nature of a network, it may require multiple log types to create one quality log source, for example, a firewall 
log and a system log used together to hold each other accountable. That is, the validity of one log can be proven using another and vice-versa.

A log source could also be collecting too much information; that is, if several types of logs are collecting the same data or creating the same alerts, it can increase noise,
storage complexity, and other consequences.

Answers:Manual,Automated

5.Using Logs Effectively

There are many types of SIEMs to choose from, and each feature and capability can impact how you can use logs effectively. If you are not using a specific feature of an SIEM,
it does not signify that you are not effectively using logs, as it depends on log sources and usage requirements. For example, if you are only using logs as an incident 
response tool and not for real-time monitoring, you may not need or use the real-time feature of some SIEMs.
As briefly introduced in task four, using multiple log types and sources is beneficial for validating logs and creating a complete story of an incident. This concept is more 
formally known as correlation or building a relationship between two things: logs and data. For example, if a user performed a suspicious action (created a DLL file on the 
disk), a browser application log could be used to correlate their browser search history with their behavior. If they were searching for a specific installer or 
troubleshooting process, it may explain the suspicious action. If email logs showed a potential phishing attempt directly followed by the suspicious action, it could cause 
more investigation. Data enrichment can also be included in correlation efforts.

6.Improving Incident Response with Accountability


Start the machine and connect with openvpn to the Tryhackme network and after 3-5 minutes you can then use the link to open a new tab.Wait till splunk loaded properly and
then on the left site you can click search&reporting and there you have the search bar for events. Select on the right site the filter All Time and then type * to search for 
everything.

Click on the filter on the right site of the searchbar and chose date range then switch to between and look up the April 15th till April 16th with the * search.
Search again with the Preset "All Time" and *. On the left side you see interesting fields and search there user and u got the answer.
When you found the user you can see that James count is 5 so you already got the next answer or use the User="Cybertees\\James" .
Look up the oldest event of James (scroll down after you used the User="Cybertees\\James" and then look through the event)
Search for the EventID there is only 1 and 3 possible,the question is kinda weird but i guess its about the wmic process that is started and it useses a network connect as
you can see in the event.

Answer is without ()
Answer:(12,256),(12,250),4,wmic,3
